# 腾讯 一面

投的后台开发，捞到了wxg客户端开发

cpp八股把

右值引用与移动语义

多继承，菱形继承的底层原理，编译器如何处理

多态的实现原理

手撕智能指针sharedptr

​    补充如何确保引用计数的线程安全，确保智能指针的性能安全

​    atomic等的使用，linux操作系统的加锁机制



# 腾讯二面

上来先问了6道算法题，分别是：

1. 两数之和：经典的leetcode第一题
2. 完全背包：2，3，5三种硬币组合成100，问方案数。一开始写了完全背包，然后脑抽了感觉不对，又写了个01背包折腾了半天，结果发现完全背包没问题。最后面试官还追问有其他更好的方法吗，当时想的是数学推一波，现在想想貌似可以用母函数做？
3. 枚举全排列，要支持任意类型：直接next_permutation冲，然后面试官让我重写一个，就写了个dfs。
4. 找中位数：写了个nth_element，然后面试官问我不知道数组长度，要边读边处理能不能做？？？？不好意思不会，直接回了一句“不可做”。
   + 用堆，求第n个最大的就用小顶堆，否则用大顶堆
5. 大数乘法：二重循环。 
6. 字符矩阵找字符串：一个dfs直接冲。

基本上每道题我写两三分钟，然后他看我代码看半天，还要我给他解释。最后这个流程走了一个小时。



MySQL索引数据结构

二叉树和平衡二叉树的区别

平衡二叉树的优点

场景题：1000万的数据，想存到MySQL里，要求查询尽可能快，怎么设计？

**redis的使用场景**

**缓存雪崩的解决方案**

**出现了缓存被打穿了，大量请求压到后端，服务自我保护机制有哪些？**

如何避免内存碎片问题？





# 腾讯天美一面 凉经

15， Vector和list的底层实现和区别是什么
16， Vector的扩容机制是怎么做的
17， 函数的多态是怎么实现的，虚函数是什么？
18， 子类继承基类，为什么使用子类会调用到子类的虚函数，会不会是基类的？
19， 析构函数是什么，做了什么？
20， 基类的析构函数为什么是虚的？
21， 为什么子类要覆写基类的析构函数？





## 算法

1. 找到链表环的入口，不存在返回nullptr（找到相交点，怎么计算相交点到入口的距离）（只找到了相交点）

> 1）先判断是否存在相交点
>
> 2）计算环的长度k（从相交点走一圈）
>
> 3）快指针先走k步，然后快慢一起走，相交为入口

1. 最近公共父节点（a）
2. 最长回文子串（a）

## 问题

1. MySQL引擎的区别（Mylsam，Innodb）
2. 频繁的插入时Innodb的性能更好么（一次可以读到内存里更多）
3. Innodb写入时一定是往后追加么，在中间插入效率会更高么，为什么不用其他引擎
4. 为什么要用B+树（和B树、线性存储对比了一下，内存能读更多）
5. unordered_map底层实现，怎么解决hash冲突，stl中使用的哪个，扩容机制（一次探测、二次探测、链表法）
6. 理解的右值
7. 为什么会引入完美转发
8. **了解过redis么**
9. **为什么redis很快，怎么实现的（单进程+epoll）**
10. **redis是线程安全的么**
11. **怎么实现的分布式锁**
12. **redis的数据结构，底层分别是怎么实现的**
13. **zlist的底层原理，数据是怎么压缩的**
14. 进程间通讯方式（管道、共享内存、消息队列、信号）
15. 管道怎么用，数据写到哪里（内核）
16. 进程切换
17. 电脑上多个app如何保证内存够用（虚拟内存、页表换入换出）
18. 介绍项目
19. 协程处理的是什么任务
20. 项目中使用协程和线程的区别
21. 什么情况适合用协程池，什么情况适合用线程池（IO密集协程，资源多线程）
22. 定时器怎么做的（epoll_wait）
23. 会发生大量epoll在等待么，测试过吞吐量么
24. 序列化和反序列化怎么做的（protobuf）
25. **如何实现一个高可靠、低延迟的定时器（给出的是发布订阅模式+redis+过期时间）**
26. **怎么做到高可靠（redis分布式）**
27. **redis的高可靠性怎么保证，宕机时怎么保证任务不会丢失（选举机制）**
28. **redis还没同步时就宕机了怎么办**
29. **redis发生内存宕机时怎么保证高可靠（写日志，仿redo log）**
30. **redis的持久化（RDB，AOF）**
31. **定时任务用redis怎么实现任务消费（发布订阅，绑定设置的键。轮询或回调。能不能用消息队列实现）**





# 腾讯天美服务端凉经

腾讯一面 40min （3.30）

- close_wait和time_wait
- tcp和udp区别
- reactor模式是什么，对比proactor模式
- epoll的底层实现，比select的优势
- 二进制数怎么确定有多少个1
- 线程池大小怎么确定
- 服务器达到多少qps，性能瓶颈在哪
- 为什么用vector实现缓冲区，有没有想过别的数据结构
- 为什么用小根堆实现定时器
- json库是干什么的
- 项目自己做的吗，有没有合作的项目，怎么分工的
- 海量数据topk，复杂度
- 普通topk除了堆还有什么解法（快排）
- 做题：ide上写一下快排解法
- 快排稳定吗，给一个不稳定的排序接口，不修改内部实现怎么让排序结果稳定



腾讯二面 40min

- 自我介绍
- select和epoll区别
- reactor模式，还有什么模式
- 多进程
- 进程间通信方式
- 状态机有哪些状态
- get和post区别
- 缓冲区作用，用vector优势
- 异步日志，写文件是直接写到磁盘吗
- top命令内存有哪些区
- tcp和udp区别，使用二者开发时有什么要注意的
- tcp粘包，http怎么解决的
- 慢查询怎么看，怎么优化
- 联合索引(a,b,c)，where a, b, c和where b, a, c区别
- 是否了解db底层
- 大端小端，见过什么大端机器
- 主机序和网络序，怎么转换
- 做题：写程序判断大小端
- 做题：01矩阵1表示可达，判断从左上角到右下角是否可达





  然后上来三道手撕，过了解锁对话（bushi 

  1.合并两个有序链表。 

  2.哈夫曼编码。 

  3.N进制转换。 



  C++基础 

内存对齐的含义？ 

为什么要内存对齐。 



## 天美 后台实习 一面 

 面试官应该写C++的，问了一大堆C和C++底层
 c++为啥用new不用malloc？

static、externC之类，名称翻译，stl容器，

map unordered_map
 然后一点操作系统（进程间通信的方式，管道，fifo，共享内存mmap到两个进程上的地址是一样的吗，硬链接和软链接，lock-free编程
 一点计算机网络（syn flood、syn cookie），HTTP版本（1.1、2.0二进制、3.0 QUIC，基于UDP做可靠传输，多路复用，队头阻塞）、对称加密非对称加密

 编程题：
 有序数组合并 O(n)
 删除单词中的空格，并返回删除的个数 O(n)
 字符串按单词翻转 O(1)额外空间 

##    天美 后台实习 二面  

晚上面的，面试官似乎有其他事情的样子，只做了蛮简单的一道题，做了几个优化，然后讲了下进一步改进的思路就结束了

  题目是统计一个文件里面出现过最多次的字符，有可能有多个。基本上是在聊细节处理，比如一次读不止一个字节的时候的读入流的处理，还有基本的性能优化（不同记录top1方式的空间/时间取舍） 

##   天美 后台实习 三面 

 static局部变量的位置 -> 数据段
 内存里除了代码以外还有啥？堆，栈，全局变量
 栈的生长方向？函数传参的方式？顺序？（讲了x86-32bit x86-64bit和riscv，寄存器+栈）
 堆做什么的？
 实现一个用户态的内存分配器，怎么实现？答了 slab 形式的分配器，预留不同大小 slab 分配，被深挖
 如何O(1)分配？讲了用空闲空间本身串联成freelist链表
 碎片化的内存块怎么分配出去？如果请求大块内存但是只有几块连续小块怎么办？ 讲了归还free的时候可以探测一下前后的空闲块，连成链，然后每个块都记录链总大小加快速度
 归还操作系统的时候，如果是碎片的内存，怎么归还？  不太知道。。。拿内存肯定是拿一大块，不知道可不可以拆分地还
 x86的引导方面有了解吗  浅说了一下x86的启动流程，说学校的以riscv为主
 riscv有特权模式吗？讲一下特权模式（从machine模式到supervisor模式到user模式全吹了一遍，每个模式可以干的事情和不可以干的事情）
 页保护，缺页异常，异常处理子程序+子程序注册，中断里面发生了什么（讲了除了可能是非法访问外，还可能是copy on write页的特殊处理，面试官提醒了换出的页和磁盘mmap页的情况）
 struct{int32,char,int16}的对齐

 提的那个enum redefinition issue说一下（这个面试官没有听我吹完，但是后面问了一句是自己发现的还是导师帮助的。。。大二哪来的导师）





# 腾讯天美一面 凉经

8.9 一面
中午约面，下午通知提前，晚上直接面，50min。

1， 手撕算法题，搜索旋转排序数组
2， 什么时候能入职
3， int类型的空间大小，int32位全一是什么值，全一再加一呢？
4， 指针的空间大小是多少
5， 指针和引用的区别是什么？
6， 如果一个int指针赋给一个double指针，double的地址是什么？
7， C++强转是什么？
8， Sizeof的大小是多少
9， 内存对齐是什么
10， 结构体，一个int，一个bool，一个int，一个bool，内存大小是多少
11， 堆内存和栈内存的区别
12， 堆内存和栈内存的性能差距
13， 一直频繁操作堆内存会发生什么
14， 内存除了堆和栈，还有什么
15， Vector和list的底层实现和区别是什么
16， Vector的扩容机制是怎么做的
17， 函数的多态是怎么实现的，虚函数是什么？
18， 子类继承基类，为什么使用子类会调用到子类的虚函数，会不会是基类的？
19， 析构函数是什么，做了什么？
20， 基类的析构函数为什么是虚的？
21， 为什么子类要覆写基类的析构函数？





# 腾讯天美游戏客户端一面

45min，无手撕，无项目，纯八股但面试官很好
0.自我介绍
1.int，long在32位，64位中的长度
2.指针占几字节
3.宏和const
4.如何将const转为非const
5.堆和栈，分别存些什么，栈中存放函数中哪些变量，函数参数的入栈顺序
6.new除了分配内存还有什么用法（求大佬解答），new重载有什么作用
7.析构函数为什么是虚函数，析构函数不是虚函数一定会造成内存泄漏吗
8.右值引用的作用，移动构造函数如何实现
9.static_cast和dynamic_cast的区别，后者转化指针或引用失败时返回什么
10.C++编译链接的过程，链接的方式，多个程序共享一个动态库,其运行时加载几次，占用谁的内存
11.两个cpp中都定义int a会不会报错
12.STL有哪些容器，map的类型，区别
13.网络编程接触过吗（直接说了没有）
14.TCP和UDP可以同时使用80端口吗
15.浏览器输入网址到呈现网页流程
16.进程和线程的区别，多线程有多少栈，无锁多线程如何协作（求解答）
17.设计模式了解哪些，MVC解决什么问题



new重载，placement new

TCP和UDP，可以同一端口吗？

几何题：长方体蛋糕任意位置有一个长方体空洞，切一刀切成相等两部分



二面：

栈溢出情况，怎么定位解决，线程栈一般多大

TCP和UDP，UDP可靠机制，UDP保证有序，UDP减少丢包率（多传去重）

TCP粘包





# 腾讯wxg后台开发二面

1. MySQL索引数据结构
2. 二叉树和平衡二叉树的区别
3. 平衡二叉树的优点
4. 场景题：1000万的数据，想存到MySQL里，要求查询尽可能快，怎么设计？
5. **redis的使用场景**
6. **缓存雪崩的解决方案**
7. **出现了缓存被打穿了，大量请求压到后端，服务自我保护机制有哪些？**
12. 垃圾回收机制
13. 如何避免内存碎片问题？
14. 实习
15. 手撕1：回文串
16. 手撕2：旋转数组
17. 反问





# 腾讯pcg一面

1.c++内存结构
2.c和cpp区别
3.虚函数
4.构造函数和析构函数
5.堆和栈
6.tcp udp
7.tcp三次握手，四次挥手
8.为什么要三次握手
9.tcp可靠性
**10.redis基础数据结构**
**11.redis基础命令**
**13.redis持久化**
14.主从架构
15.redis故障发现、故障恢复
16.redis底层数据结构

17. Io多路复用

18.写时拷贝零拷贝
**19.redis热键**
20.给一个数组求出现次数最多的最大值
22.走格子
23.忘了
**24.redis过期时间怎么实现的**
**25.一亿个要过期的key，怎么处理的**
后面还有，忘了，一个小时20分钟





# （8.24）腾讯后台开发一面

八股问的不多，大部分都是场景题

自我介绍
项目介绍
项目相关问题
用户态和内核态
三级缓存
fork的读时共享，写时拷贝
fork在写时拷贝之前，直接拷贝的内容
fork会拷贝页表吗
虚拟内存
B+树
你提到三层树结构，怎么做能使得查询不需要3次io？
讲一讲https加密
为什么既需要非对称，又需要对称加密？

然后还补充问了几个简历上没写的

讲讲NAT

手撕：翻转数组，矩阵置零







# （8.26）腾讯后台开发二面

开局手撕，复杂链表的复制，先用哈希表写出来之后再优化成原地拷贝。手撕完之后全程项目拷打。

1. 服务器和客户端连接建立的具体过程（先讲应用层socket的运作，包括如何实现和内核的同步等等。再讲tcp在这些过程中状态机的切换）



2. 客户端的connect是如何绑定四元组的（显式绑定远端，内核自动分配端口，用路由表绑定网卡ip）



3. 连接建立的过程中，tcp包内部各个字段的变化（标志位+窗口大小+MSS）



4. 序列号的大小是根据什么变化的（syn+fin+数据）



5. 滑动窗口+拥塞控制详细讲解



6. 慢启动的时候，直接double很可能丢包，怎么调节使得慢启动阶段不丢包（考虑嗅探网络带宽，用第一个ack的来回时间来试探网络性能）



7. MSS的作用（送分题）



8. 发送和接收的时候，socket内部的结构如何保证你说的这些（iss+ack+seq）



9. 窗口大小只有65535，16位，在后来带宽变大之后，这个窗口太小了，怎么办（不改变协议字段，仿照ipv4的IHL字段，乘以4）



10. 面试官原话，如果接着往下推，要去学一下分布式
